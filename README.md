# 수질 예측 회귀 모델 비교 (ElasticNet vs Random Forest)

 이 프로젝트는 실제 수질 데이터를 활용하여 **pH 수치 예측**을 위한 회귀 모델을 구축하고,  
**ElasticNet 회귀**와 **Random Forest 회귀**의 성능을 비교하며, 
과적합 문제와 특성 기여도 부분을 해석하는 머신러닝 실험입니다.

---

## 🔍 프로젝트 개요

- **데이터**: `water_quality.csv` (수온, 용존산소, 총질소, 총인, TOC, 페놀, 시안 등 포함) (서울시 공공데이터)
- **목표**: pH 수치를 연속적으로 예측하는 회귀 모델 학습
- **비교 모델**:
  1. ElasticNet 회귀 (다항 특성 + 정규화)
  2. Random Forest 회귀 (비선형 앙상블)

---

## 🔍 모델별 성능 비교

### ✅ ElasticNet 회귀 (다항 특성 + 표준화)

| 지표       | 학습 데이터 | 테스트 데이터 |
|------------|--------------|----------------|
| MAE        | 0.1690       | 0.1141         |
| RMSE       | 0.2085       | 0.1709         |
| 일반화 성능 | ✅ 우수 (Train/Test 비슷) |

---

### ✅ Random Forest 회귀

| 지표       | 학습 데이터 | 테스트 데이터 |
|------------|--------------|----------------|
| MAE        | 0.0516       | 0.1570         |
| RMSE       | 0.0734       | 0.2765         |
| 일반화 성능 | ⚠️ 과적합 경향 (Train ≪ Test) |

---

## 🧪 결론 요약

- **ElasticNet**은 해석이 가능하고 안정적인 예측 성능을 보였으며,  
- **Random Forest**는 복잡한 패턴을 학습했지만 과적합으로 인해 테스트 오차가 더 높았음  
- Random Forest 모델의 트리 개수, 트리 깊이를 제한하고 리프(Leaf) 노드에 남을 최소 샘플 수를 5개로 지정하여 과적합을 최대한 완화하였으나 여전히 과적합 경향을 나타냄.

ElasticNet 회귀 결과, 수온(temperature)이 pH 농도에 가장 큰 양의 영향을 미쳤으며,
특히 중랑천(station_name_중랑천)에서의 측정값은 기본적으로 pH가 높게 나타나는 경향이 있었다.
또한, 중랑천에서 온도가 높을 경우 pH가 더욱 상승하는 상호작용 효과가 관찰되었고, 온도와 용존산소(DO)도 서로 상호작용하는 관계가 관찰되었다.
총질소(TN)는 음의 방향으로 pH에 영향을 주는 것으로 나타났다.
중랑천에서의 총질소(TN)가 높을 경우 pH는 더욱 낮아지는 미세한 상호작용 효과 또한 관찰되었다.

Random Forest 회귀 결과, pH 농도 예측에 가장 큰 영향을 준 특성은 **수온(temperature)** 으로, 전체 중요도 중 **50.4%** 를 차지하며 매우 높은 기여도를 보였다.
이어서 "중랑천" 특성이 **11.7%** 의 중요도로 2위를 기록하며, 중랑천에서 수온이 높을수록 pH가 크게 달라지는 경향이 있다는 점을 시사한다. 세 번째로 중요한 특성은 **총질소(TN)** 로, **12.5%** 의 기여도를 나타냈으며, 이는 수질 오염 지표인 질소가 pH 변화에 중요한 변수임을 나타낸다.
이 외에도, **용존산소(DO)**, **총유기탄소(TOC)**, **총인(TP)** 등도 중요도를 보였지만 미미한 것으로 분석되었다. 측정소의 위치, 총질소(TN)이 비로소 변화가 있을만큼 영향을 주었고, 온도 변화가 예측에 가장 큰 영향을 줌을 시사한다. 그러나 Random Forest의 학습 데이터와 테스트 데이터의 오차율이 ElasticNet 회귀 방법보다 무려 4배나 높았기 때문에 잘못된 예측을 하는 일명 'Fake Insight'를 유발할 수 있다.

결과적으로, 이번 수질 예측 모델링 프로젝트의 최종 모델로 ElasticNet 회귀를 채택했다. 모델 성능 평가 결과, ElasticNet은 테스트 데이터에서 0.1924의 안정적인 RMSE를 기록한 반면, 복잡한 비선형 관계 학습을 위해 시도했던 Random Forest는 심각한 과적합(훈련 RMSE: 0.0734 vs 테스트 RMSE: 0.2765)으로 인해 일반화 성능이 떨어져 최종 모델로 부적합했다. 최종 선택된 ElasticNet 모델의 계수 분석을 통해, 수온(temperature)과 pH가 예측에 가장 중요한 변수임을 확인했으며, 특히 중랑천 측정소의 데이터가 결과에 유의미한 영향을 미친다는 점을 파악했다. 비록 Random Forest를 통해 복잡한 패턴 학습을 시도했으나 과적합 문제를 해결하지 못했던 한계는 있었지만, 결론적으로 이번 프로젝트에서는 안정적인 일반화 성능과 명확한 해석 가능성을 모두 확보한 ElasticNet이 가장 합리적이고 신뢰할 수 있는 모델이라고 판단했다.
